
  ___  ____  ____  ____  ____ (R)
 /__    /   ____/   /   ____/
___/   /   /___/   /   /___/   16.0   Copyright 1985-2019 StataCorp LLC
  Statistics/Data Analysis            StataCorp
                                      4905 Lakeway Drive
     MP - Parallel Edition            College Station, Texas 77845 USA
                                      800-STATA-PC        http://www.stata.com
                                      979-696-4600        stata@stata.com
                                      979-696-4601 (fax)

Single-user 2-core Stata perpetual license:
       Serial number:  501606204617
         Licensed to:  Miklos Koren
                       CEU MicroData

Notes:
      1.  Stata is running in batch mode.
      2.  Unicode is supported; see help unicode_advice.
      3.  More than 2 billion observations are allowed; see help obs_advice.
      4.  Maximum number of variables is set to 5000; see help set_maxvar.

. do specmeasures.do 

. do "set_globals.do"

. preserve

.         use "data/derived/shares.dta", clear

. 
.         su sector

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
      sector |      3,009           2    .8166323          1          3

.         global S = r(max)

.         su country

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     country |      3,009    30.38385    17.06332          1         60

.         global J = r(max)

.         su year

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      3,009    1990.297    5.652809       1980       1999

.         global tmin = r(min)

.         global tmax = r(max)

.         global T = $tmax-$tmin+1

. 
.         * calc global factor 
.         * though we put it in ind factors and not use it separately
.         egen glbf = mean(shock), by(year)
(612 missing values generated)

. 
.         * calculate the sectoral means as fixed effect estimates of the indus
> try factors
.         egen indf = mean(shock), by(sector year)
(612 missing values generated)

. 
.         * calculate country means, this has measurement error!
.         egen cntf = mean(shock-indf), by(country year)
(933 missing values generated)

. 
.         * calculate even more residuals
.         gen epsilon = shock - indf - cntf
(940 missing values generated)

. 
.         su epsilon

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |      2,069   -6.08e-10    .3562923  -3.639615   3.075612

.         scalar sigma2 = r(Var)

. 
.         * let sigma change with j and s
.         * this is denote dnsigma (del negro's sigma)
.         * egen dnsigma = sd(epsilon), by(country sector)
. 
.         matrix dnsigma2 = J($S,$J,0)

.         forval s = 1/$S {
  2.                 forval j = 1/$J {
  3.                         su epsilon if (country==`j')&(sector==`s')
  4.                         matrix dnsigma2[`s',`j'] = r(Var)
  5.                 }
  6.         }

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5   -.1201173    .1458058  -.2852283   .0566212

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    -.012299     .178967  -.2574005   .2426137

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0062728    .0947259  -.1404076   .2197258

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5   -.1857502    .3539785  -.5510497   .2820332

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         14    .1902398     .144148   .0017139   .4924413

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0064511    .0853066  -.1932068   .1360153

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5   -.2887649    .3665579  -.5843326   .3287938

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         10    .0425959    .2481315  -.3511683   .4640749

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0548592    .2652167  -.2674238   .5921289

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0360091    .1541786  -.1988974   .2924813

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5    .1521153    .1030763   .0396546   .2507032

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .1597077    .1493404  -.2438396   .3430139

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          8    .0746997    .1579194  -.1690688   .2398506

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         11    .0736295    .1746207   -.222949   .3020815

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0321713    .1884184  -.3567816   .2813063

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         10    .0034317    .0801559  -.1124856   .1055551

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         14    .0748474    .1801147  -.1113392     .35052

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5    .1781581    .2351887  -.1050005    .383416

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          8   -.4281846    .8599929  -1.690244   .8631769

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0321254    .1028809  -.1312348   .2099372

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .3274906    .4647706  -.1040919   1.088947

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0833273    .1166325  -.1232322   .2570398

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         11    .0675682    1.917467  -3.002411   3.075612

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0200287    .3538875  -.5749311   .4057456

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .1198808    .0867471  -.0229756   .2844332

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         12    .1274694    .2331075   -.220067   .4030854

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0013731     .094249  -.1239422   .2354299

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .1113348    .1697869  -.1022081   .3431646

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0308438    .0821465  -.0794515   .1842596

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.1783109    .6897529  -1.224837   .3437942

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5   -.4942305    .2353274   -.737798  -.1239622

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0829951    .2286289  -.1655203   .4823884

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         11    .0551067    .1202914  -.1159299   .2796711

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          6    .0955222    .2291814  -.2439988   .3252367

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5    .2621689    .3753113  -.0448525   .7794251

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0514124    .0964015  -.0937468   .2283953

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15     .049244    .1829105  -.3078203   .2621767

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5   -.1149586    .1441427  -.2245654   .1266616

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15     .071126     .108412  -.1535397   .2366992

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0609058    .1679552   -.211525   .3364291

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         12   -.5034611     .977791  -2.276549   .6042303

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5   -1.024585    .6985056  -1.604412   .1747711

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0811462    .1066276   -.078291   .2697177

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5    .1790033    .0914885   .0760957   .2918554

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          9   -.0876486    .0647677  -.1621179   .0353788

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         10   -.3322333    .2331799  -.6793864  -.0321471

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         13   -.8078999    1.898178  -3.639615   .7518123

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .1768852    .1299727  -.1589658   .3029104

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0663666    .1423998  -.1864538   .3244957

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0063861    .2742421  -.4232017   .5105115

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0042142    .2451255  -.4245509   .4598123

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         10   -.2698198    .9901515  -2.168976   .4143834

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          6     .242555    .1889187   .0013414   .4441736

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0598349    .3605432  -.4808575   .5872153

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0002553    .1181905  -.2208241   .2195624

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0950088    .1434051  -.1419334   .4128295

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          6    .1789154    .2080816  -.2044623   .3586185

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5   -.4537274    .2389608  -.6487014  -.1598737

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          8   -.0652793    .1503226  -.2350551    .171457

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         11    .1559707    .1048247   .0275639   .3454667

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5    .3103298     .265453   .0470693   .7219541

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0077093    .0945178  -.1249744   .1411161

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0299102    .0557825  -.0534932   .1201791

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5    .0790072    .1892937  -.1207465   .3345395

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         14   -.0789534     .102376  -.2603481   .0785835

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15      .00236     .051293  -.0580012   .0874224

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5    .0500033    .2366459  -.3377397   .2494963

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         10   -.0751476    .1875591  -.4647697   .1714026

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.1366485    .2006697  -.4567654   .2515501

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0134429    .0660687  -.1430791   .0877746

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5   -.0581605    .0868921  -.1399969   .0866229

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.1484204    .1252274  -.2900067   .1657219

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          8     .099504    .0330183   .0597175   .1406249

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         11   -.1000148    .1536885  -.3177484    .230367

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0336464    .1308928  -.3029693   .1703917

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         10   -.0021748    .0266431  -.0348531   .0432402

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         14   -.0361864    .0772729   -.155965   .0458351

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          7    -.203865    .1723939  -.4572116   .0418503

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          8    .1785912    .3950934  -.3982947   .8611037

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0001028    .0504019  -.1158215   .0898351

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.1516592    .2292381  -.5478095   .0765625

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15     -.04498    .0675486  -.1628631   .0468213

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         11    .0390743    .8248782  -1.274162   1.404707

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0204454    .1779175  -.1760134   .3046465

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0236914    .0617737  -.1247703   .0810448

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         12   -.0955483    .1957261  -.3045133   .4107013

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0522537    .0542117  -.0429076   .1511732

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0827718     .113185  -.2464674   .0672031

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    -.046691    .0651572  -.1758526   .0402008

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0618351    .3050839  -.2331295   .5461646

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5    .1073071    .1396252  -.0497705   .3316088

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0573246    .1326538  -.2977774   .0673694

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         11   -.0466417    .1201272  -.2320064   .0964104

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          6    .0081504    .1771969  -.1731459   .3150532

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5   -.0646446     .126133  -.2446346    .026821

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0258552    .0561041   -.136651   .0697724

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    -.021028    .1094686  -.1835162   .1484054

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5    .0083723    .0993064  -.1539735   .1108755

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0304186    .1117297  -.2498215   .1511806

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0240344    .0853195  -.1228431   .1213461

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         12     .293841    .4751185  -.2022582   1.144748

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5    .6774338    .3896792   .0101229   1.019505

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.1080824    .0549717  -.2104691  -.0026387

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5   -.1165054    .0659375  -.2028241  -.0512859

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          9    .0473575    .0382534   .0064186   .1113027

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         10    .2633493    .3012264  -.1988544   .6793864

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         13    .3547278    .8444119  -.3600472   1.654819

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0862538    .0781993   -.162619   .0936076

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0127187    .0732049  -.1581039   .1165963

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0362873    .1797166   -.174418   .4286393

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0171789    .2306558  -.3964521   .3205929

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         10    .0873265    .5542434  -.3340207   1.135597

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          6   -.0766257    .1415008  -.2421674   .1227825

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    -.047832    .2173966  -.3596253   .2958376

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0190961     .050228  -.1312818   .0531508

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0406345    .2075152  -.4146163   .1773377

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          6   -.2497232    .1332044  -.4595652  -.0520928

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5    .2281282    .0694972   .1082958   .2759632

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          8    .0616643    .2222691  -.1933001   .3069007

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         11   -.0470925    .0896678  -.1553081   .1270442

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5   -.1902125    .2353122  -.4835126    .078208

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0200083    .1005659  -.1282381   .1401406

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0361831    .0887313  -.2015785   .1150453

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5     .106743    .2348349  -.1612867     .45798

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         14   -.1112864    .1696824  -.2980352   .1770606

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0040911    .0647312  -.1105058   .1057844

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5    .2387616    .1324029   .0089459   .3348363

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         10    .0325517    .1304096  -.1081244   .2614987

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0817893    .2053232  -.2778564   .3331421

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0225661    .1037303  -.2187783   .1111228

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5   -.0939548    .1316509  -.2761883   .0573838

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0112873    .0824133  -.1515419   .1446932

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          8   -.1742037    .1519293  -.3386326   .0630151

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         11    .0263852    .1127474  -.1743579   .1784517

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0658178    .2333676  -.2352125   .4117267

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         10   -.0012568    .0797601  -.0920776   .1324006

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         14    -.038661    .1063224   -.194555   .0959641

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          7    .0766092    .0881992  -.0474457   .1826137

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          8    .2495934    .4752212  -.4648822   .8291401

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0320226    .0778796  -.1634174   .0829678

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.1758314    .2370953  -.5411376   .0696188

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0383474    .0652977  -.1401552   .0792074

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         11   -.1066425    1.097004   -1.80145   1.597703

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0004168    .1853036  -.2640697   .2702846

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0961895    .0630327  -.2491951  -.0192419

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         12    -.031921    .2502815  -.3773142   .3461852

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0508806    .0709505  -.1925224   .0469126

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    -.028563    .0716889  -.1579479   .0545477

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0158471    .0388711  -.0406253   .0862484

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .1164757    .3939589  -.2787284   .7067078

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5    .3869234    .1465663   .1737327   .5604348

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0256705    .1214232  -.1857371   .1729979

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         11    -.008465    .1108875  -.2515848   .1527789

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          6   -.1036727    .1318155  -.2080514   .1506608

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5   -.1975243    .3236532  -.5639499   .0978794

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0255572    .0656255  -.1422962   .1218312

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0282161    .0923923    -.12355   .1893606

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5    .1065863    .0577329   .0273119   .1665157

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0407074    .0789322  -.1364883   .1013568

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0849402     .118615  -.2175561   .1257712

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         12    .2096201    .5095909  -.4019722     1.1318

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5    .3471509     .309623   -.184894   .5849071

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0269362    .0709849  -.0939937   .1526252

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5   -.0624979    .0529172  -.1250762   .0070218

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          9    .0402911     .066604  -.0806319   .0996065

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5     .137768     .148405  -.0385318   .3333637

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         13    .4531721    1.055635  -.3917652   2.020976

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0906314    .0656909  -.1679937   .0653582

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0536479      .07871  -.1913631   .0860087

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0426734    .1771187  -.3459826     .17355

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0129647    .1510136  -.2427281   .3148912

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         10    .1824933     .439953  -.1220565   1.033379

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          6   -.1659293      .09706  -.2227076   .0276402

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    -.012003    .1487708  -.3059567   .2095786

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15    .0188407    .0827504  -.1000885   .2018645

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         15   -.0543743    .2086009  -.3343035   .3140849

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          6    .0708079    .1779808  -.1257014   .2805871

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          5    .2255992    .2677228  -.0726875   .5062032

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |          8     .003615    .2103986  -.4043201   .2065114

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     epsilon |         11   -.1088782    .0819282  -.2114583   .0467779

. restore

. 
end of do-file

. 
. use "data/derived/allfactors.dta", clear

. 
. * estimate pairwise covariances 
. matrix S = J($S+$J,$S+$J,0)

. matname S Fc1-Fc$J Fs1 Fs2-Fs$S, rows(.)

. matname S Fc1-Fc$J Fs1 Fs2-Fs$S, col(.)

. 
. foreach X of varlist Fc1-Fc$J Fs1 Fs2-Fs$S {
  2.     foreach Y of varlist Fc1-Fc$J Fs1 Fs2-Fs$S {
  3.         capture matrix accum Spair = `X' `Y', nocons
  4.         capture matrix S[rownumb(S,"`X'"),colnumb(S,"`Y'")] = Spair[2,1]/r
> (N)
  5.     }
  6. }

. 
. 
. matrix Varcnt = S["Fc1".."Fc$J","Fc1".."Fc$J"]

. matrix Varind = S["Fs1".."Fs$S","Fs1".."Fs$S"]

. matrix Covindcnt = S["Fc1".."Fc$J","Fs1".."Fs$S"]

. 
. 
. 
. 
. * read in mean returns
. use "data/derived/meanlaborprod_wide.dta", clear

. 
. sort country

. 
. * rename vars to be compatible with shares
. foreach X of num 1/$S {
  2.     ren laborprod`X' Fs`X'
  3. }

. 
. mkmat Fs1-Fs$S, mat(Mu)

. mat list Mu

Mu[60,3]
           Fs1        Fs2        Fs3
 r1  73.961159  156.54813  91.489502
 r2  211.80698  318.02194  248.23065
 r3  13.547022  30.588539  35.073162
 r4  565.55475  966.36023  433.37704
 r5  142.20393  132.69464  147.08136
 r6  10.009276  13.815854  12.420688
 r7  107.45264  15.770095    9.87885
 r8  1.595e+11  8.230e+11  4.367e+11
 r9  13699.782  26683.182  17408.119
r10  215.28398  418.49701  276.66235
r11  .84463066  1.8214611  2.1805472
r12  .39016783  1.4344766  .78670734
r13  2.0220714  11.151366   13.32007
r14  14.023803  1.1518329  .73393732
r15  3.3942058  5.7399292  4.0958972
r16  257.34741  492.22977  645.84497
r17  43.810593  52.473862  56.402725
r18  .09556653  .06069123  .03409643
r19  57.231953  22.299238  22.421694
r20  40.719246  75.825211  64.740234
r21   90.88401  65.648193  66.447273
r22  1.2496938  2.8781531  3.4791911
r23   58.01329  22.363905  25.641483
r24  19.757095   37.75021  69.821861
r25  15.367484  15.525837  15.873207
r26  .00775648  .05847027  .02368496
r27  345.85336  694.94531  519.41595
r28  .13329132  .29607239  .32241172
r29  1.1260259  3.6478736  3.4480832
r30  .11203103  .14781895   .1172289
r31  4575.6655  4583.8145  2728.6309
r32  8.1245632  14.803655  16.289749
r33   28.25765  65.245514  40.664921
r34  235.75716   1103.856  1583.0933
r35  .35348529  .73560584  2.3174257
r36  171.60379  222.47281  175.41631
r37  200.28151   285.1987  264.23828
r38  69.276779  149.93973  113.42907
r39  37.915527  102.95947  61.671928
r40  1.0616373  2.3876429  3.1597955
r41  2.3165357  .16903175  .13036065
r42  916.51825  128.50963  101.77602
r43  2.5841138  13.284178  6.0275197
r44  24.936562   110.7592  106.82823
r45  1.5418637  2.3920083  3.3131697
r46  1.3263092  2.3626635  1.9304264
r47  150.07866   71.60759  56.813297
r48  1.1877635  2.7982788  2.9511361
r49  43.254181  54.511021  47.053238
r50  .50054741  5.5585332  4.6795087
r51  11.046886   67.89727  40.627701
r52  .43636993  .11051138   .1229725
r53  26.835297  82.423622  68.314102
r54  798.91132  767.76208  640.17645
r55  383.21194  600.07983  542.70764
r56  4.9831929  23.048958  10.316508
r57  263.70764   342.2265  262.55127
r58  2597.5203  1880.5714  1426.8129
r59  1291.7261  1415.0959  910.21948
r60  47.285427  143.82228  184.50206

. 
. * read in labor shares
. use "data/derived/preparedshares.dta", clear

. 
. foreach X of num 1/$S {
  2.     ren share`X' Fs`X'
  3. }

. 
. * min var portfolio
. count
  1,003

. gen b0 = .
(1,003 missing values generated)

. gen b1 = .
(1,003 missing values generated)

. gen b2 = .
(1,003 missing values generated)

. gen m = .
(1,003 missing values generated)

. gen TAU2=.
(1,003 missing values generated)

. gen BETA=.
(1,003 missing values generated)

. 
. forval Y=1/$S {
  2.         matrix nicelittlevector=Varind["Fs`Y'",1..$S]
  3.         matrix score SigmaFs`Y'=nicelittlevector
  4.         replace SigmaFs`Y'=SigmaFs`Y'*Fs`Y'
  5. }
(1,003 real changes made)
(1,003 real changes made)
(1,003 real changes made)

. forval Y=1/$S {
  2.         gen sqFs`Y'=Fs`Y'^2
  3. }

. egen SECT=rsum(SigmaFs1 - SigmaFs$S)

. su SECT

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        SECT |      1,003    .0062159    .0029218   .0009402   .0104022

. egen HERF=rsum(sqFs1 - sqFs$S)

. replace HERF=HERF*sigma2
(1,003 real changes made)

. su HERF

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        HERF |      1,003    .0581286    .0101583   .0426459   .0840785

. 
. * del Negro's HERF is dnHERF
. * this is a weighted sum of squares
. gen dnHERF=0

. forval s = 1/$S {
  2.         forval j = 1/$J {
  3.                 replace dnHERF = dnHERF+sqFs`s'*dnsigma2[`s',`j'] if count
> ry==`j'
  4.         }
  5. }
(10 real changes made)
(20 real changes made)
(20 real changes made)
(10 real changes made)
(19 real changes made)
(20 real changes made)
(10 real changes made)
(17 real changes made)
(20 real changes made)
(20 real changes made)
(11 real changes made)
(20 real changes made)
(14 real changes made)
(16 real changes made)
(20 real changes made)
(15 real changes made)
(19 real changes made)
(10 real changes made)
(14 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(17 real changes made)
(20 real changes made)
(20 real changes made)
(17 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(10 real changes made)
(20 real changes made)
(18 real changes made)
(12 real changes made)
(10 real changes made)
(20 real changes made)
(20 real changes made)
(10 real changes made)
(20 real changes made)
(20 real changes made)
(17 real changes made)
(10 real changes made)
(20 real changes made)
(10 real changes made)
(14 real changes made)
(12 real changes made)
(19 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(16 real changes made)
(15 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(11 real changes made)
(10 real changes made)
(13 real changes made)
(17 real changes made)
(10 real changes made)
(20 real changes made)
(20 real changes made)
(10 real changes made)
(19 real changes made)
(20 real changes made)
(10 real changes made)
(17 real changes made)
(20 real changes made)
(20 real changes made)
(11 real changes made)
(20 real changes made)
(14 real changes made)
(16 real changes made)
(20 real changes made)
(15 real changes made)
(19 real changes made)
(10 real changes made)
(14 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(17 real changes made)
(20 real changes made)
(20 real changes made)
(17 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(10 real changes made)
(20 real changes made)
(18 real changes made)
(12 real changes made)
(10 real changes made)
(20 real changes made)
(20 real changes made)
(10 real changes made)
(20 real changes made)
(20 real changes made)
(17 real changes made)
(10 real changes made)
(20 real changes made)
(10 real changes made)
(14 real changes made)
(12 real changes made)
(19 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(16 real changes made)
(15 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(11 real changes made)
(10 real changes made)
(13 real changes made)
(17 real changes made)
(10 real changes made)
(20 real changes made)
(20 real changes made)
(10 real changes made)
(19 real changes made)
(20 real changes made)
(10 real changes made)
(17 real changes made)
(20 real changes made)
(20 real changes made)
(11 real changes made)
(20 real changes made)
(14 real changes made)
(16 real changes made)
(20 real changes made)
(15 real changes made)
(19 real changes made)
(10 real changes made)
(14 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(17 real changes made)
(20 real changes made)
(20 real changes made)
(17 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(10 real changes made)
(20 real changes made)
(18 real changes made)
(12 real changes made)
(10 real changes made)
(20 real changes made)
(20 real changes made)
(10 real changes made)
(20 real changes made)
(20 real changes made)
(17 real changes made)
(10 real changes made)
(20 real changes made)
(10 real changes made)
(14 real changes made)
(12 real changes made)
(19 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(16 real changes made)
(15 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(11 real changes made)
(10 real changes made)
(13 real changes made)
(17 real changes made)

. 
. **this calculates the residual
. matrix residual=J($S,1,0)

. matrix residual = dnsigma2 * J($J,1,1/$J)

. forval X = 1/$J {
  2.     di in gre "Country # " in ye `X'
  3. ********* have to change omega here if we want to use dnHERF
. * this is the old one, just in case
. *    matrix Omega = Varind+Covindcnt["Fc`X'","Fs1".."Fs$S"]'*J(1,$S,1)+J($S,1
> ,1)*Covindcnt["Fc`X'","Fs1".."Fs$S"]+ Varcnt[rownumb(Varcnt,"Fc`X'"),colnumb(
> Varcnt,"Fc`X'")]*J($S,$S,1)+sigma2*I($S)
. * and here comes the new one
.     matrix Omega = Varind+Covindcnt["Fc`X'","Fs1".."Fs$S"]'*J(1,$S,1)+J($S,1,
> 1)*Covindcnt["Fc`X'","Fs1".."Fs$S"]+ Varcnt[rownumb(Varcnt,"Fc`X'"),colnumb(V
> arcnt,"Fc`X'")]*J($S,$S,1)+diag(dnsigma2[1..$S,`X'])
  4.     matrix mu = Mu[`X',1..$S]
  5. 
. 
. 
. * this calcs current mean return using labor shares
.     capture drop mtemp
  6.     matrix score mtemp = mu
  7.     replace m=mtemp if country==`X'
  8. 
.     matrix A = (mu*inv(Omega)*mu', J(1,$S,1)*inv(Omega)*mu' \ J(1,$S,1)*inv(O
> mega)*mu' , J(1,$S,1)*inv(Omega)*J($S,1,1))
  9.     matrix core = inv(A) 
 10. * the previous formula was the same but longer
.     replace b0 = core[2,2] if country==`X'
 11.     replace b1 = core[2,1]+core[1,2] if country==`X'
 12.     replace b2 = core[1,1] if country==`X'
 13. 
.         replace TAU2 = Varcnt[rownumb(Varcnt,"Fc`X'"),colnumb(Varcnt,"Fc`X'")
> ] if country==`X'
 14.         capture drop BETAtmp
 15.         matrix nicelittlevector=Covindcnt["Fc`X'","Fs1".."Fs$S"]
 16.         matrix score BETAtmp = nicelittlevector
 17.         replace BETA = BETAtmp/TAU2 if country==`X'
 18. 
. }
Country # 1
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
Country # 2
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 3
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 4
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
Country # 5
(19 real changes made)
(19 real changes made)
(19 real changes made)
(19 real changes made)
(19 real changes made)
(19 real changes made)
Country # 6
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 7
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
Country # 8
(17 real changes made)
(17 real changes made)
(17 real changes made)
(17 real changes made)
(17 real changes made)
(17 real changes made)
Country # 9
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 10
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 11
(11 real changes made)
(11 real changes made)
(11 real changes made)
(11 real changes made)
(11 real changes made)
(11 real changes made)
Country # 12
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 13
(14 real changes made)
(14 real changes made)
(14 real changes made)
(14 real changes made)
(14 real changes made)
(14 real changes made)
Country # 14
(16 real changes made)
(16 real changes made)
(16 real changes made)
(16 real changes made)
(16 real changes made)
(16 real changes made)
Country # 15
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 16
(15 real changes made)
(15 real changes made)
(15 real changes made)
(15 real changes made)
(15 real changes made)
(15 real changes made)
Country # 17
(19 real changes made)
(19 real changes made)
(19 real changes made)
(19 real changes made)
(19 real changes made)
(19 real changes made)
Country # 18
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
Country # 19
(14 real changes made)
(14 real changes made)
(14 real changes made)
(14 real changes made)
(14 real changes made)
(14 real changes made)
Country # 20
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 21
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 22
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 23
(17 real changes made)
(17 real changes made)
(17 real changes made)
(17 real changes made)
(17 real changes made)
(17 real changes made)
Country # 24
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 25
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 26
(17 real changes made)
(17 real changes made)
(17 real changes made)
(17 real changes made)
(17 real changes made)
(17 real changes made)
Country # 27
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 28
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 29
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 30
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 31
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
Country # 32
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 33
(18 real changes made)
(18 real changes made)
(18 real changes made)
(18 real changes made)
(18 real changes made)
(18 real changes made)
Country # 34
(12 real changes made)
(12 real changes made)
(12 real changes made)
(12 real changes made)
(12 real changes made)
(12 real changes made)
Country # 35
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
Country # 36
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 37
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 38
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
Country # 39
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 40
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 41
(17 real changes made)
(17 real changes made)
(17 real changes made)
(17 real changes made)
(17 real changes made)
(17 real changes made)
Country # 42
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
Country # 43
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 44
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
Country # 45
(14 real changes made)
(14 real changes made)
(14 real changes made)
(14 real changes made)
(14 real changes made)
(14 real changes made)
Country # 46
(12 real changes made)
(12 real changes made)
(12 real changes made)
(12 real changes made)
(12 real changes made)
(12 real changes made)
Country # 47
(19 real changes made)
(19 real changes made)
(19 real changes made)
(19 real changes made)
(19 real changes made)
(19 real changes made)
Country # 48
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 49
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 50
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 51
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 52
(16 real changes made)
(16 real changes made)
(16 real changes made)
(16 real changes made)
(16 real changes made)
(16 real changes made)
Country # 53
(15 real changes made)
(15 real changes made)
(15 real changes made)
(15 real changes made)
(15 real changes made)
(15 real changes made)
Country # 54
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 55
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 56
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
(20 real changes made)
Country # 57
(11 real changes made)
(11 real changes made)
(11 real changes made)
(11 real changes made)
(11 real changes made)
(11 real changes made)
Country # 58
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
(10 real changes made)
Country # 59
(13 real changes made)
(13 real changes made)
(13 real changes made)
(13 real changes made)
(13 real changes made)
(13 real changes made)
Country # 60
(17 real changes made)
(17 real changes made)
(17 real changes made)
(17 real changes made)
(17 real changes made)
(17 real changes made)

. 
. gen V = b0+b1*m+b2*m^2

. * this is the lowest risk for the given mean
. 
. gen RISK = SECT+HERF+2*BETA*TAU2+TAU2

. gen dnRISK = SECT+dnHERF+2*BETA*TAU2+TAU2

. * this is the overall 
. 
. gen COV2 = 2*BETA*TAU2

. 
. gen MIN = b0-b1^2/(4*b2)

. * this is the absolute lowest risk
. 
. gen minM = -b1/(2*b2)

. * this is the corresponding mean
. 
. 
. * how many years in sample?
. egen N = count(Fs1), by(country)

. 
. sort cnum year

. 
. tempfile sm

. save `sm', replace 
(note: file /var/folders/f4/7drmhl1d5kj3wp1r33jvx32m0000gn/T//St01680.000001 no
> t found)
file /var/folders/f4/7drmhl1d5kj3wp1r33jvx32m0000gn/T//St01680.000001 saved

. 
. 
. * now merge with stuff
. use "data/wdi/wdinew.dta", clear

. keep cnum cname year rgdppcp pop 

. sort cnum year

. merge cnum year using `sm'
(note: you are using old merge syntax; see [D] merge for new syntax)

. drop _

. sort cnum year

. 
. merge 1:1 cnum year using "data/pwt/pwt1.dta", keep(master match) nogen

    Result                           # of obs.
    -----------------------------------------
    not matched                         2,480
        from master                     2,480  
        from using                          0  

    matched                             5,760  
    -----------------------------------------

. 
. save "data/derived/specmeasures.dta", replace
file data/derived/specmeasures.dta saved

. 
. 
end of do-file
